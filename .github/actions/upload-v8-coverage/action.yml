name: Upload V8 coverage
description: Upload V8 coverage artifacts.
inputs:
  name:
    description: Artifact name.
    required: true
  path:
    description: Coverage path to upload (defaults to name).
    required: false
    default: ""

runs:
  using: composite
  steps:
    - name: Normalize artifact name
      id: normalize
      shell: bash
      run: |
        name="${{ inputs.name }}"
        echo "name=${name//\//-}" >> "$GITHUB_OUTPUT"
        if [ -n "${{ inputs.path }}" ]; then
          echo "path=${{ inputs.path }}" >> "$GITHUB_OUTPUT"
        else
          echo "path=${{ inputs.name }}" >> "$GITHUB_OUTPUT"
        fi

    - name: Upload coverage artifact
      uses: actions/upload-artifact@v4
      with:
        name: ${{ steps.normalize.outputs.name }}
        # package.json anchors uploaded paths to the repository root.
        path: |
          package.json
          ${{ steps.normalize.outputs.path }}
