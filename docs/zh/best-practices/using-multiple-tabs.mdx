---
title: "使用多个标签页"
description: "用 Stagehand 操作多个标签页"
---

许多现代网页应用会在用户点击某些按钮或链接时打开新的标签页。缺乏完善的多标签页支持时，一旦期望内容出现在新标签页而非当前标签页，自动化脚本就可能失败。Stagehand 的多标签页功能可确保你的自动化在多标签页工作流中无缝运行。

## Stagehand 页面

Stagehand 会自动适配多标签页工作流。`stagehand.page` 对象始终指向最近打开或当前活动的标签页，确保即使新标签页被创建，你的自动化也能继续运行。

这意味着你可以继续使用熟悉的模式：

<CodeGroup>
  ```typescript TypeScript
  const page = stagehand.page;
  await page.goto("https://example.com");
  await page.act("click the button that opens a new tab");
  // page now automatically points to the new tab
  await page.extract("get data from new tab");
  ```

  ```python Python
  page = stagehand.page
  await page.goto("https://example.com")
  await page.act("click the button that opens a new tab")
  # page now automatically points to the new tab
  await page.extract("get data from new tab")
  ```
</CodeGroup>

<Warning>
  **重要**： [Stagehand Agent](/zh/basics/agent) 将始终作用于 `stagehand.page`。如果需要让代理在特定多个标签页之间工作，你需要手动管理页面切换。
</Warning>

## 手动管理页面

若需更精细的控制或多标签页工作流，你可以显式管理多个标签页：

<CodeGroup>
  ```typescript TypeScript
  // 创建第二个页面
  await stagehand.context.newPage();
  const pages = stagehand.context.pages();

  const githubPage = pages[0];
  const pythonPage = pages[1];

  // 将每个页面分别导航到不同的仓库
  await githubPage.goto("https://github.com/browserbase/stagehand");
  await pythonPage.goto("https://github.com/browserbase/stagehand-python");

  // 同时从两个页面提取数据
  const [stagehandStars, stagehandPythonStars] = await Promise.all([
    githubPage.extract("提取该仓库的 star 数"),
    pythonPage.extract("提取该仓库的 star 数")
  ]);

  console.log(`Stagehand stars: ${stagehandStars}`);
  console.log(`Stagehand-Python stars: ${stagehandPythonStars}`);
  ```

  ```python Python
  # 创建第二个页面
  await stagehand.context.new_page()
  pages = stagehand.context.pages()

  github_page = pages[0]
  python_page = pages[1]

  # 将每个页面分别导航到不同的仓库  
  await github_page.goto("https://github.com/browserbase/stagehand")
  await python_page.goto("https://github.com/browserbase/stagehand-python")

  # 从两个页面提取数据
  stagehand_stars = await github_page.extract("提取该仓库的 star 数")
  stagehand_python_stars = await python_page.extract("提取该仓库的 star 数")

  print(f"Stagehand stars: {stagehand_stars}")
  print(f"Stagehand-Python stars: {stagehand_python_stars}")
  ```
</CodeGroup>

## 处理标签页事件

你也可以监听标签页事件，以控制新标签页打开时的行为：

<CodeGroup>
  ```typescript TypeScript
  const page = stagehand.page;
  await page.goto("https://browserbase.github.io/stagehand-eval-sites/sites/five-tab/");

  // 新标签页打开后将其关闭
  page.on("popup", async () => {
    const newPage = stagehand.context.pages()[1];
    await newPage.close();
  });

  await page.act("click the button to open the other page");

  const page_number = await page.extract("extract the page number");
  console.log(`You're on page ${page_number}`);
  ```

  ```python Python
  page = stagehand.page
  await page.goto("https://browserbase.github.io/stagehand-eval-sites/sites/five-tab/")

  # 新标签页打开后将其关闭
  async def handle_popup():
      new_page = stagehand.context.pages()[1]
      await new_page.close()

  page.on("popup", handle_popup)

  await page.act("click the button to open the other page")

  page_number = await page.extract("extract the page number")
  print(f"You're on page {page_number}")
  ```
</CodeGroup>

## 后续步骤

<CardGroup cols={2}>
  <Card title="使用 Agent 编排复杂工作流" icon="robot" iconType="sharp-solid" href="/zh/basics/agent">
    使用 `Agent()` 自主执行多步任务与复杂工作流。
  </Card>

  <Card title="处理 iframes" icon="frame" iconType="sharp-solid" href="/zh/best-practices/working-with-iframes">
    了解在 iframes 内与元素交互的最佳实践。
  </Card>

  <Card title="浏览器配置" icon="browser" iconType="sharp-solid" href="/zh/configuration/browser">
    管理浏览器上下文与会话，以应对复杂的自动化场景。
  </Card>

  <Card title="日志与调试" icon="bug" iconType="sharp-solid" href="/zh/configuration/logging">
    优雅地处理错误并高效调试自动化问题。
  </Card>
</CardGroup>