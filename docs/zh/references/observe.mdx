---
title: observe()
description: "observe() 方法的完整 API 参考"
icon: "magnifying-glass"
---

<CardGroup cols={1}>
  <Card title="Observe" icon="magnifying-glass" href="/zh/basics/observe">
    了解如何使用 observe() 来发现可执行元素并分析网页结构
  </Card>
</CardGroup>

### 方法签名

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    // 使用 ObserveOptions
    await page.observe(options: ObserveOptions): Promise<ObserveResult[]>

    // 字符串指令简写
    await page.observe(instruction: string): Promise<ObserveResult[]>
    ```

    **ObserveOptions 接口：**

    ```typescript
    interface ObserveOptions {
      instruction?: string;
      modelName?: AvailableModel;
      modelClientOptions?: ClientOptions;
      domSettleTimeoutMs?: number;
      drawOverlay?: boolean;
      iframes?: boolean;
    }
    ```
  </Tab>

  <Tab title="Python">
    ```python
    # 通过参数调用
    await page.observe(
        instruction: str,
        dom_settle_timeout_ms: int = None,
        iframes: bool = None,
        model_name: AvailableModel = None,
        model_client_options: Dict = None
    ) -> List[ObserveResult]
    ```
  </Tab>
</Tabs>

### 参数

<ParamField path="instruction" type="string" optional>
  对待发现元素或操作的自然语言描述。
</ParamField>

<ParamField path="modelName" type="AvailableModel" optional>
  覆盖此次观察所使用的默认 LLM 模型。
</ParamField>

<ParamField path="modelClientOptions" type="ClientOptions" optional>
  模型专用的配置选项。
</ParamField>

<ParamField path="domSettleTimeoutMs" type="number" optional>
  在分析前等待 DOM 稳定的最长时间（毫秒）。

  **默认值：** `30000`
</ParamField>

<ParamField path="drawOverlay" type="boolean" optional>
  是否在发现的元素上绘制可视化高亮层（用于调试）。

  **默认值：** `false`
</ParamField>

<ParamField path="iframes" type="boolean" optional>
  设为 `true` 以在 iframe 中搜索。

  **默认值：** `false`
</ParamField>

### 响应

**返回：** `Promise<ObserveResult[]>`

按相关性排序的可执行元素数组。

**ObserveResult 接口：**

```typescript
interface ObserveResult {
  selector: string;        // 用于定位元素的 XPath 选择器
  description: string;     // 面向人的可读描述
  method?: string;         // 建议的操作方法
  arguments?: string[];    // 该操作的附加参数
}
```

<ParamField path="selector" type="string">
  精确定位元素的 XPath 选择器。
</ParamField>

<ParamField path="description" type="string">
  关于元素及其用途的面向人的可读描述。
</ParamField>

<ParamField path="method" type="string" optional>
  建议的交互方法："click"、"fill"、"selectOptionFromDropdown"、"nextChunk"、"scrollTo"、"prevChunk"。
</ParamField>

<ParamField path="arguments" type="string[]" optional>
  建议操作的附加参数。
</ParamField>

### 代码示例

<CodeGroup>
  ```typescript TypeScript
  // 基础元素发现
  const buttons = await page.observe("查找所有可点击按钮");
  const formFields = await page.observe("定位表单输入字段");

  // 高级配置
  const elements = await page.observe({
    instruction: "查找重要的号召性按钮（CTA）",
    modelName: "gpt-4.1-mini",
    domSettleTimeoutMs: 45000,
    drawOverlay: true
  });

  // 处理结果
  const [loginButton] = await page.observe("查找登录按钮");
  if (loginButton) {
    console.log("已找到：", loginButton.description);
    console.log("选择器：", loginButton.selector);
    await page.act(loginButton); // 执行动作
  }

  // 过滤结果
  const submitButtons = await page.observe("查找所有提交按钮");
  const primarySubmit = submitButtons.find(btn => 
    btn.description.toLowerCase().includes('primary')
  );

  // Iframe 搜索
  const iframeElements = await page.observe({
    instruction: "查找 iframe 内的表单字段",
    iframes: true
  });
  ```

  ```python Python
  # 基础元素发现
  buttons = await page.observe("查找所有可点击按钮")
  form_fields = await page.observe("定位表单输入字段")

  # 高级配置  
  elements = await page.observe(
      instruction="查找重要的号召性按钮（CTA）",
      model_name="gpt-4.1-mini",
      dom_settle_timeout_ms=45000
  )

  # 处理结果
  login_buttons = await page.observe("查找登录按钮")
  if login_buttons:
      button = login_buttons[0]
      print("已找到：", button.description)
      print("选择器：", button.selector)
      await page.act(button)  # 执行动作

  # 过滤结果
  submit_buttons = await page.observe("查找所有提交按钮")
  primary_submit = next((
      btn for btn in submit_buttons 
      if 'primary' in btn.description.lower()
  ), None)

  # Iframe 搜索
  iframe_elements = await page.observe(
      instruction="查找 iframe 内的表单字段",
      iframes=True
  )
  ```
</CodeGroup>

### 集成模式

<CodeGroup>
  ```typescript TypeScript
  // Observe → Act 工作流
  const actions = await page.observe("查找结账相关元素");
  for (const action of actions) {
    await page.act(action);
    await page.waitForTimeout(1000);
  }

  // Observe → Extract 工作流
  const tables = await page.observe("查找数据表格");
  if (tables.length > 0) {
    const data = await page.extract({
      instruction: "提取表格数据",
      selector: tables[0].selector,
      schema: DataSchema
    });
  }

  // 元素验证
  const requiredElements = await page.observe("查找登录表单");
  if (requiredElements.length === 0) {
    throw new Error("未找到登录表单");
  }
  ```

  ```python Python
  # Observe → Act 工作流  
  actions = await page.observe("查找结账相关元素")
  for action in actions:
      await page.act(action)
      await page.wait_for_timeout(1000)

  # Observe → Extract 工作流
  tables = await page.observe("查找数据表格")
  if tables:
      data = await page.extract(
          instruction="提取表格数据",
          selector=tables[0].selector,
          schema=DataSchema
      )

  # 元素验证
  required_elements = await page.observe("查找登录表单")
  if not required_elements:
      raise Exception("未找到登录表单")
  ```
</CodeGroup>